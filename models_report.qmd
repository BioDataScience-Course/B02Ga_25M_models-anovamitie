---
title: "Cannibalisme chez les serpents"
author: "Louise Dubrecq, Sarah Delapierre, Martin Jadouille, Charlotte De Saeger"
format:
  pdf:
    documentclass: report
    toc: true
editor: visual
lang: fr
bibliography: references.bib
---

<!--# Un rapport est différent d'un carnet de notes. Il ne s'agit donc pas de faire du copier-coller d'un document vers l'autre. Un rapport de synthèse doit être compréhensible sans devoir lire le carnet de notes. Le rapport de synthèse doit être  rédigé avec un style et une présentation adéquats. -->

## Introduction

<!--% Rédigez l'introduction de ce rapport en 5-6 phrases.-->

Le jeu de données utilisé dans ce document est tiré d'une recherche sur le cannibalisme entre serpents [@wu2021]. Les serpents des espèces kingsnakes et cornsnakes sont connus pour leurs patterns colorés et distingués, ainsi que pour leur ophiophagie. En effet, ces espèces s'attaquent à d'autres espèces de serpent afin de s'alimenter. Ces deux espèces partagent leur habitat et vivent en Amérique du Nord, dans des prairies ou des clairières.

## But

<!--% Rédigez le but de ce rapport en 2 phrases.-->

Le but de cette analyse est de déterminer si la morphologie et les patterns des juvéniles influencent l'attaque de serpents adultes. Le temps avant l'attaque est également mesuré afin de déterminer si les attaques surviennent rapidement ou non.

## Matériel et méthodes

<!--% Cette section doit comprendre deux parties. La première partie doit expliciter les données employées et la seconde traiter des analyses réalisées et des logiciels employés.-->

Les données ont été collectées par *Wu Nicholas* *et al* et sont en accès libre (MIT Licence, <https://doi.org/10.5281/zenodo.5399271>)**.** Toutes les informations sur les données, le déroulé des expériences et le dictionnaire des données sont disponibles dans l'article.

Les expériences ont été réalisée en plaçant, dans une boîte fermée, un individu adulte et un individu juvénile. Le temps d'attaque a été chronométrée pour chaque expérience.

Différentes régressions linéaires et modèles linéaires sont utilisés afin de modéliser les données. Au préalable, une description des données est réalisée pour les représenter. Le seuil $\alpha$ de tous les tests est fixé à l'avance à 5%.

L'analyse est réalisée avec le logiciel R (`r R.version.string`) et en particulier le package {modelit} version `r packageVersion("modelit")` avec la [SciViews Box 2025](https://www.sciviews.org/software/svbox/) dans [Saturn Cloud](https://saturncloud.io/) (Linux Ubuntu 22.04).

## Résultats

<!--% Présentez les deux modèles les plus pertinents que vous avez sélectionnés. Structurez la section en deux parties avec deux titres de niveau trois.-->

```{r setup, include=FALSE}
# Ceci est nécessaire pour les tests SDD, ne pas utiliser dans un "vrai" projet
if (!"tools:tests" %in% search())
  source(here::here("tests/tools_tests.R"), attach(NULL, name = "tools:tests"))
# Configure Knitr to use AGG as graphic device
knitr::opts_chunk$set(dev = "ragg_png")

# Configuration de l'environnement
SciViews::R("model")
```

```{r import}
# Lecture des données
snakerev <- read("data/snake.rds")
# Tableau des premières et dernières lignes
tabularise$headtail(snakerev)
skimr::skim(snakerev)
snakerev<-smutate(snakerev, juvenile_sex = as.factor(juvenile_sex), pattern = as.factor(pattern), painted = as.factor(painted), pred_attempt = as.factor(juvenile_sex), prey_species = as.factor(prey_species), adult_sex  = as.factor(adult_sex)
)
#Création d'une nouvelle variable
snakerev <- snakerev %>%
  smutate(
    ratio_mass = adult_mass_g / juvenile_mass_g,
    ratio_svl = adult_svl_cm / juvenile_svl_cm
  )
snakerev <- labelise(snakerev, 
  label = list(
    ratio_mass = "Rapport entre la masse de l'adulte et du juvénile",
    ratio_svl = "Rapport entre la taille de l'adulte et du juvénile"), 
  units=list(
      ratio_mass = "NA",
    ratio_svl = "NA"
  ))

#On vire ceux qui n'attaquent pas car pas intéressant pour certains tests.
snake_only_attaque <- snakerev %>%
  filter(time_to_attack_s < 900)

```

### Modèle linéaire généralisé 1

```{r model 1}
snake_mod1_gen <- glm(data = snakerev, pred_attempt_bin ~ ratio_mass + ratio_svl+ + 0, family = binomial)
summary(snake_mod1_gen) |>tabularise()

```

L'ajustement du modèle est relativement bon même s'il y a une légère sous-dispersion. (186.3/198=0.94).

Le coefficient du ratio_mass est positif, cela signifie qu'un ratio adulte/juvénile élevé (adulte beaucoup plus lourd que le juvénile) augmente la probabilité d'attaque. L’effet du ratio des masses sur la probabilité d'attaque est significatif au seuil alpha de 5%. (p-value\<0.05) et son estimation est relativement bonne (0.229/1.31 = 0.17).

Le coefficient du ratio_svl est négatif, cela signifie qu'un ratio adulte/juvénile élevé pour la longueur museau-cloaque diminue la probabilité d'attaque. L’effet du ratio des tailles sur la la probabilité d'attaque est significatif au seuil alpha de 5%. (p-value\<0.05) et son estimation est relativement bonne (0.357/-2.21 = -0.16).

### Modèle linéaire généralisé 2

```{r model 2}
snake_modglm_test <- glm(data = snakerev, time_to_attack_s ~ pattern + prey_species, family = gaussian)
summary(snake_modglm_test) |>tabularise()
```

Tous les termes du modèle sont significativement différents du premier niveau de chacune des variables qualitatives, c'est à dire le pattern normal pour les serpents de l'espèce Cornsnake au seuil α = 5 % sauf le terme relatif aux serpents qui ont (déjà) des motifs et qui ont été peints (patternPainted).

L'estimation des paramètres est moyenne pour les serpents avec des motifs et qui sont peints (ratio écart type vs valeur estimée ≈ 0.56), bonne pour ceux qui ayant des motifs et qui sont peints aléatoirement (ratio ≈ 0.24.) et pour ceux ayant des motifs mais non peints (ratio ≈ 0.16), et très bonne pour les juvéniles de l'espèce Kingsnake (ratio ≈ 0.11)

La moyenne du temps avant l'attaque diminue pour ceux ayant des motifs (et qui sont peints ou non) et ceux ayant des motifs et qui sont peints aléatoirement, ce qui indique qu'ils sont attaqués plus rapidement. Pour les juvéniles de l'espèce Kingsnake, la moyenne augmente ce qui indique qu'ils sont attaqués plus lentement.

## Discussion et Conclusion

<!--% En tenant compte du but de votre carnet de notes et de vos résultats, discutez de résultats et proposez des conclusions à votre analyse en 5 à 10 phrases. -->

Le but de cette recherche était de déterminer le lien entre la morphologie et les patterns des juvéniles et le temps avant l'attaque. Ces liens ont été démontrés dans nos modèles linéaires généralisés, car les interactions entre le temps avant l'attaque et les variables sur la morphologie et sur le pattern sont significatives au seuil alpha de 5%. Ces analyses nous montrent donc que les juvéniles les plus grands sont attaqués plus rapidement et que les juvéniles possédant des patterns, peints ou non, sont plus attaqués que les juvéniles n'en ayant pas. De plus, nous pouvons remarquer que les serpents de l'espèce *kingsnake* sont moins attaqués que les serpents de l'espèce *cornsnake*.

Nous concluons qu'effectivement, la morphologie et les patterns des juvéniles ont un lien avec l'attaque, et notamment la rapidité de cette attaque.

## Bibliographie
